# SREP Configuration for HP AMI BIOS (o.bin)
# CORRECTED VERSION - Loads module from FV before patching
# Generated from analysis of https://github.com/EduardoA3677/UEFITool/releases/download/A73/o.bin
# 
# IMPORTANT: The Setup/TSE modules are NOT loaded at runtime initially
# We must use LoadFromFV to load them first, THEN patch, THEN execute
#
# Based on runtime analysis showing 181 modules but no Setup module loaded

# ===========================================
# LOAD SETUP MODULE FROM FIRMWARE VOLUME
# ===========================================

# First, load the AMI TSE Setup module from the Firmware Volume
# This module contains the form structures we need to patch
Op LoadFromFV
AMITSESetup

# ===========================================
# HP CUSTOM SETUP FORMS - Multiple patterns
# Now patch the loaded module
# ===========================================

# Pattern 1: HPSetupData principal (offset 0x3c0db4)
# Desbloquea formularios principales de configuración HP
Op Patch
Pattern
0548505365747570446174610000010100000000
0548505365747570446174610000010101000000

# Pattern 2: HPSetupData alternativo (offset 0x3c0db5)
# Desbloquea menús avanzados HP
Op Patch
Pattern
4850536574757044617461000001010000000000
4850536574757044617461000001010001000000

# Pattern 3: Formulario HP tipo 1 (offset 0x3c0e11)
# Desbloquea opciones de configuración avanzada
Op Patch
Pattern
0000000000000000030101000101000100000000
0000000000000000030101000101000101000000

# Pattern 4: Formulario HP tipo 2 (offset 0x3c0e12)
# Desbloquea más opciones ocultas
Op Patch
Pattern
0000000000000003010100010100010000000000
0000000000000003010100010100010001000000

# Pattern 5: Formulario HP tipo 3 (offset 0x3c0e13)
# Menús adicionales de HP
Op Patch
Pattern
0000000000000301010001010001000000000000
0000000000000301010001010001000001000000

# Pattern 6: Formulario HP tipo 4 (offset 0x3c0e14)
# Opciones avanzadas de sistema
Op Patch
Pattern
0000000000030101000101000100000000000000
0000000000030101000101000100000001000000

# Pattern 7: Formulario HP tipo 5 (offset 0x3c0e15)
# Configuraciones adicionales
Op Patch
Pattern
0000000003010100010100010000000000000000
0000000003010100010100010000000001000000

# Pattern 8: NewHPSetupData principal (offset 0x3c0e40)
# Nuevas estructuras de configuración HP
Op Patch
Pattern
7748505365747570446174610000010100000000
7748505365747570446174610000010101000000

# Pattern 9: NewHPSetupData alternativo (offset 0x3c0e41)
# Formularios adicionales HP
Op Patch
Pattern
4850536574757044617461000001010000000000
4850536574757044617461000001010001000000

# ===========================================
# EJECUTAR EL SETUP UTILITY
# ===========================================

# Now execute the patched setup module to show unlocked menus
Op Exec
